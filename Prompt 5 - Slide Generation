# Slide Generation with React Artifact
## Interactive Preview & PowerPoint Export

---

# üîó PIPELINE INTEGRATION

| Field | Value |
|-------|-------|
| **Stage** | 5 of 5 (Final) |
| **Role** | React Artifact Generation with Live Preview & PPTX Export |
| **Input** | STAGE_4_HANDOFF package (JSON specification) |
| **Output** | React Artifact (.jsx) + FINAL_DELIVERABLES package |
| **Previous Stage** | Prompt 4 - Slide Design Specification |
| **Next Stage** | None (terminal stage) |

**Pipeline Context**: This prompt is Stage 5 (final) of a 5-stage pipeline. Transform the JSON specification from Stage 4 into a React artifact that renders an interactive slide preview in the browser AND generates a downloadable .pptx file using PptxGenJS‚Äîall client-side, no external tools required.

**Standalone Use**: This prompt can be used independently with any valid JSON slide specification.

---

# RULES & CONSTRAINTS

| Rule | Description |
|------|-------------|
| **JSON-faithful** | All slide content must come from Stage 4 JSON specification |
| **Single artifact** | Output ONE complete React component that handles both preview and export |
| **PptxGenJS required** | Use PptxGenJS library for .pptx generation |
| **Self-contained** | All styles must be inline or in the artifact (no external CSS) |
| **No external deps** | Only use React, PptxGenJS, and standard browser APIs |

**Override Protection**: The Generation Brief cannot override these rules.

---

## C ‚Äì Context

You are a **React artifact engineer** specializing in presentation generation. Your task is to transform a validated JSON slide specification into a complete React component that:

1. **Previews slides** in an interactive browser view with navigation
2. **Exports .pptx** using PptxGenJS when the user clicks download
3. **Runs entirely client-side** within Claude.ai's artifact sandbox

**Technical Environment**:
- Claude.ai artifacts support React with inline styles
- PptxGenJS is available via CDN import in artifacts
- No file system access‚Äîdownload triggers browser save dialog
- No Node.js‚Äîall code runs in browser

---

## O ‚Äì Objective

Transform the JSON slide specification into a **single React artifact** that delivers:

1. **Live Slide Preview**: Paginated view showing each slide with faithful design rendering
2. **Navigation Controls**: Previous/Next buttons, slide counter, thumbnail strip
3. **Download Button**: Generates and downloads a real .pptx file using PptxGenJS
4. **Design Fidelity**: Colors, fonts, and layouts match the JSON specification

**Success Criteria**:
- User can preview all slides in browser
- User can download a working .pptx file
- No Python, no local setup, no external tools needed

---

## S ‚Äì Style

- **Production-grade React**: Clean, functional components with hooks
- **Inline styles**: All styling embedded (no external CSS dependencies)
- **Commented code**: Brief comments explaining key sections
- **Modular structure**: Logical separation of preview vs. export logic

---

## T ‚Äì Tone

Precise, technical, implementation-focused.

---

## A ‚Äì Audience

- **End users**: Executives, consultants viewing slides in Claude.ai
- **Technical reviewers**: Developers who may modify the artifact
- **Claude.ai runtime**: Must execute in artifact sandbox

---

# CHAIN OF THOUGHT (CoT) FRAMEWORK

For each major design decision, document reasoning:

```markdown
### CoT: [Decision Point]

**Context**: [What needs to be decided]

**Options Considered**:
1. [Option A]: [Pros/Cons]
2. [Option B]: [Pros/Cons]
3. [Option C]: [Pros/Cons]

**Decision**: [Selected option]

**Rationale**: [Why this best serves the goal]
```

**Required CoT Decisions**:
1. Component architecture (single vs. multi-component)
2. State management approach
3. Slide rendering strategy
4. PptxGenJS integration pattern
5. Chart rendering approach
6. Styling methodology

---

# CHAIN OF DENSITY (CoD) FRAMEWORK

Apply 3-pass density refinement to artifact code:

| Pass | Focus | Target |
|------|-------|--------|
| **Pass 1: Verbose** | Full implementation with extensive comments, verbose naming | Clarity |
| **Pass 2: Standard** | Balanced code with essential comments | Readability |
| **Pass 3: Dense** | Optimized code, minimal comments, concise naming | Performance |

**Selection Criteria**: Use **Standard** density for final output (balances readability with size).

---

# MULTI-PASS PROCESS

---

## Pass 1: JSON Analysis & Component Planning

### 1.1 Parse JSON Specification

Extract from STAGE_4_HANDOFF:

| Element | Value | React Implication |
|---------|-------|-------------------|
| Slide count | [#] | Pagination state range |
| Design system | [colors, fonts] | CSS variable definitions |
| Layout templates used | [list] | Component variants needed |
| Chart types | [list] | Chart rendering functions |
| Image/icon count | [#] | Placeholder handling |

### 1.2 Component Architecture (CoT Required)

```markdown
### CoT: Component Architecture

**Context**: Need to structure React artifact for preview + export

**Options Considered**:
1. Single monolithic component: All logic in one file
   - Pros: Self-contained, no import issues
   - Cons: Large, harder to read
2. Multiple components in one artifact: Separate SlidePreview, Navigation, etc.
   - Pros: Clean separation
   - Cons: Artifact sandbox limitations
3. Functional components with hooks: Clean, modern React
   - Pros: Best practices, readable
   - Cons: Requires useState/useEffect understanding

**Decision**: [Single artifact with internal functional components]

**Rationale**: Claude.ai artifacts work best with self-contained code. Internal component functions provide structure without import complexity.
```

### 1.3 State Requirements

| State Variable | Type | Purpose |
|----------------|------|---------|
| `currentSlide` | number | Active slide index |
| `slides` | array | Parsed slide data (main + appendix) |
| `appendixSlides` | array | Appendix slides (separate navigation) |
| `isGenerating` | boolean | Download in progress |
| `error` | string/null | Error message for display |
| `designSystem` | object | Colors, fonts, layouts |
| `showAppendix` | boolean | Toggle appendix view |

### 1.4 Keyboard Navigation (Required)

```javascript
// Add keyboard event listener in useEffect
useEffect(() => {
  const handleKeyDown = (e) => {
    if (e.key === 'ArrowRight' || e.key === ' ') {
      setCurrentSlide(prev => Math.min(prev + 1, slides.length - 1));
    } else if (e.key === 'ArrowLeft') {
      setCurrentSlide(prev => Math.max(prev - 1, 0));
    } else if (e.key === 'Home') {
      setCurrentSlide(0);
    } else if (e.key === 'End') {
      setCurrentSlide(slides.length - 1);
    } else if (e.key === 'a' || e.key === 'A') {
      setShowAppendix(prev => !prev); // Toggle appendix
    }
  };

  window.addEventListener('keydown', handleKeyDown);
  return () => window.removeEventListener('keydown', handleKeyDown);
}, [slides.length]);
```

### 1.5 Appendix Slide Handling

```javascript
// Separate main slides from appendix slides
const mainSlides = slides.filter(s => !s.appendix_id);
const appendixSlides = slides.filter(s => s.appendix_id);

// Appendix renders in separate section with trigger questions
const renderAppendixSection = () => (
  <div style={styles.appendixSection}>
    <h3>Appendix Slides</h3>
    {appendixSlides.map((slide, idx) => (
      <div key={slide.appendix_id} style={styles.appendixCard}>
        <strong>{slide.appendix_id}: {slide.title}</strong>
        <p>Trigger: "{slide.trigger_question}"</p>
        <button onClick={() => jumpToSlide(mainSlides.length + idx)}>
          View Slide
        </button>
      </div>
    ))}
  </div>
);
```

---

## Pass 2: Design System Extraction

### 2.1 Color Mapping

**Map P4's `design_system.color_palette` to CSS:**

| P4 JSON Field | CSS Variable | Usage |
|---------------|--------------|-------|
| `color_palette.primary` | --color-primary | Headers, buttons |
| `color_palette.secondary` | --color-secondary | Accents, hover |
| `color_palette.accent` | --color-accent | Highlights, callouts |
| `color_palette.background` | --color-bg | Slide background |
| `color_palette.text_primary` | --color-text | Body text |
| `color_palette.text_secondary` | --color-text-muted | Captions, footnotes |
| `color_palette.chart_colors` | Array | Chart series colors |

### 2.2 Typography Mapping

**Map P4's `design_system.typography` to CSS:**

| P4 JSON Field | CSS Property | Notes |
|---------------|--------------|-------|
| `typography.title_font` | fontFamily (h1, h2) | Use with fallback stack |
| `typography.title_size` | fontSize (h1) | Convert pt ‚Üí px (*1.33) |
| `typography.body_font` | fontFamily (p, li) | Use with fallback stack |
| `typography.body_size` | fontSize (p) | Convert pt ‚Üí px (*1.33) |
| `typography.font_fallback` | Append to fontFamily | Web-safe fallbacks |

**Font Fallback Pattern:**
```javascript
const titleFont = `"${typography.title_font}", ${typography.font_fallback?.join(', ') || '"Segoe UI", Arial, sans-serif'}`;
const bodyFont = `"${typography.body_font}", ${typography.font_fallback?.join(', ') || 'Calibri, "Helvetica Neue", sans-serif'}`;
```

### 2.3 Layout Constants

```javascript
const LAYOUT = {
  slideWidth: 960,      // 16:9 at reasonable browser size
  slideHeight: 540,
  padding: 40,
  titleHeight: 80,
  contentArea: { top: 100, bottom: 60 }
};
```

---

## Pass 3: Slide Rendering Logic (CoT Required)

### 3.1 Template Renderer Strategy

```markdown
### CoT: Slide Rendering Strategy

**Context**: JSON has multiple layout templates (title_only, two_column, chart_focus, etc.)

**Options Considered**:
1. Switch statement: Render by template type
   - Pros: Clear, explicit
   - Cons: Long switch block
2. Template components: Separate component per layout
   - Pros: Clean separation
   - Cons: More code
3. Dynamic builder: Build from content_blocks array
   - Pros: Flexible
   - Cons: Complex positioning

**Decision**: [Switch statement with inline rendering]

**Rationale**: Explicit mapping ensures each template renders correctly. Limited template count (5-8) keeps switch manageable.
```

### 3.2 Template Rendering Functions

**Template names must match P4 output exactly:**

| Template (from P4) | Render Logic |
|-------------------|--------------|
| `title_centered` | Centered title, subtitle below, primary bg |
| `title_content` | Title top, bullets/content below |
| `content_visual_split` | 60/40 split, text left, visual right |
| `visual_content_split` | 40/60 split, visual left, text right |
| `chart_focus` | Title, large chart area (80% height) |
| `two_column` | 50/50 split, content in each |
| `three_column` | 33/33/33 split, three content areas |
| `callout_quote` | Large centered quote with attribution |
| `section_divider` | Centered section title, accent bg |
| `action_items` | Title + numbered action items |
| `appendix` | Smaller title, dense content, gray bg |

### 3.3 Content Block Renderer

For each `content_block` type:

| Type | React Rendering |
|------|-----------------|
| `bullet_list` | `<ul>` with styled `<li>` |
| `numbered_list` | `<ol>` with styled `<li>` |
| `paragraph` | `<p>` with body styling |
| `callout_box` | Bordered `<div>` with accent |
| `data_point` | Large number + label |

---

## Pass 4: Chart Rendering Strategy (CoT Required)

### 4.1 Chart Approach Decision

```markdown
### CoT: Chart Rendering Approach

**Context**: JSON specifies charts (bar, line, pie). Need to render in preview AND in PPTX.

**Options Considered**:
1. SVG generation: Hand-coded SVG for each chart type
   - Pros: Full control, works in both preview and export
   - Cons: Complex math, lots of code
2. Chart library (Recharts/Chart.js): Use existing library
   - Pros: Easy preview
   - Cons: May not be available in artifact sandbox
3. Simple visual approximation: Styled divs for bar charts, canvas for pie
   - Pros: Lightweight
   - Cons: Less accurate
4. PptxGenJS native charts: Only render charts in export, use placeholder in preview
   - Pros: PPTX charts are native Excel-linked
   - Cons: Preview doesn't match export

**Decision**: [SVG generation for preview + PptxGenJS native charts for export]

**Rationale**: SVG gives accurate preview; PptxGenJS has native chart support that creates proper Excel-linked charts in the .pptx file.
```

### 4.2 SVG Chart Functions (for Preview)

```javascript
// Define chart generators for preview rendering
const renderBarChart = (data, colors) => { /* SVG bars */ };
const renderLineChart = (data, colors) => { /* SVG path */ };
const renderPieChart = (data, colors) => { /* SVG arcs */ };
const renderDonutChart = (data, colors) => { /* SVG arcs with center cut */ };
```

### 4.3 PptxGenJS Chart Mapping (for Export)

| JSON Chart Type | PptxGenJS Method |
|-----------------|------------------|
| `bar_vertical` | `slide.addChart(pptx.ChartType.bar, ...)` |
| `bar_horizontal` | `slide.addChart(pptx.ChartType.bar, {barDir: 'bar'})` |
| `line` | `slide.addChart(pptx.ChartType.line, ...)` |
| `pie` | `slide.addChart(pptx.ChartType.pie, ...)` |
| `donut` | `slide.addChart(pptx.ChartType.doughnut, ...)` |

---

## Pass 5: PptxGenJS Integration (CoT Required)

### 5.1 Library Integration Pattern

```markdown
### CoT: PptxGenJS Integration

**Context**: Need to load PptxGenJS in Claude.ai artifact sandbox

**Options Considered**:
1. Import from CDN in artifact: `<script src="...">`
   - Pros: Standard approach
   - Cons: Artifact may not support external scripts
2. Dynamic import: `import('https://cdn...')`
   - Pros: Modern, async
   - Cons: CORS issues possible
3. Assume PptxGenJS is available globally: `window.PptxGenJS`
   - Pros: Simple if available
   - Cons: May not be pre-loaded
4. Inline bundled version: Include minified PptxGenJS in artifact
   - Pros: Guaranteed availability
   - Cons: Large artifact size

**Decision**: [Dynamic import with fallback error handling]

**Rationale**: Claude.ai artifacts support dynamic imports from CDNs. Include error handling if import fails.
```

**REQUIRED: PptxGenJS CDN URL**:
```javascript
// Use this exact CDN URL for PptxGenJS import
const PPTXGENJS_CDN = 'https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js';

// Dynamic import pattern
const loadPptxGenJS = async () => {
  try {
    // Method 1: Dynamic script injection (more reliable in artifacts)
    return new Promise((resolve, reject) => {
      if (window.PptxGenJS) {
        resolve(window.PptxGenJS);
        return;
      }
      const script = document.createElement('script');
      script.src = PPTXGENJS_CDN;
      script.onload = () => resolve(window.PptxGenJS);
      script.onerror = () => reject(new Error('Failed to load PptxGenJS'));
      document.head.appendChild(script);
    });
  } catch (err) {
    throw new Error(`PptxGenJS load failed: ${err.message}`);
  }
};
```

**REQUIRED: Error Handling Pattern**:
```javascript
const handleDownload = async () => {
  setIsGenerating(true);
  setError(null);

  try {
    const PptxGenJS = await loadPptxGenJS();
    const pptx = new PptxGenJS();

    // ... generate slides ...

    await pptx.writeFile({ fileName: `${presentationTitle}.pptx` });
  } catch (err) {
    setError(`Export failed: ${err.message}. Try refreshing the page.`);
    console.error('PPTX generation error:', err);
  } finally {
    setIsGenerating(false);
  }
};
```

### 5.2 Export Function Structure

```javascript
const generatePptx = async (slides, designSystem) => {
  // 1. Initialize PptxGenJS
  const pptx = new PptxGenJS();

  // 2. Set presentation properties
  pptx.layout = 'LAYOUT_16x9';
  pptx.title = designSystem.metadata.title;

  // 3. Define master slide with design system
  pptx.defineSlideMaster({
    title: 'CUSTOM',
    background: { color: designSystem.colors.background },
    // ... font definitions
  });

  // 4. Generate each slide
  slides.forEach(slideData => {
    const slide = pptx.addSlide({ masterName: 'CUSTOM' });
    // Add title, content, charts based on slideData
  });

  // 5. Trigger download
  await pptx.writeFile({ fileName: 'presentation.pptx' });
};
```

### 5.3 Slide Element Mapping

| JSON Element | PptxGenJS Method |
|--------------|------------------|
| `title.text` | `slide.addText(title, {x, y, fontSize, bold: true})` |
| `content_blocks[].bullet_list` | `slide.addText(bullets, {bullet: true})` |
| `content_blocks[].paragraph` | `slide.addText(text, {x, y, w, h})` |
| `visual_elements[].chart` | `slide.addChart(type, data, options)` |
| `visual_elements[].image` | `slide.addImage({path, x, y, w, h})` |
| `speaker_notes` | `slide.addNotes(text)` |

---

## Pass 6: React Artifact Generation (CoD Applied)

### 6.1 Artifact Structure

```jsx
// === SLIDE PRESENTATION ARTIFACT ===
// Generated from Stage 4 JSON Specification
// Features: Live Preview + PPTX Download + Keyboard Nav + Appendix Support

import React, { useState, useEffect } from 'react';

export default function SlideDeck() {
  // --- STATE ---
  const [currentSlide, setCurrentSlide] = useState(0);
  const [isGenerating, setIsGenerating] = useState(false);
  const [error, setError] = useState(null);
  const [showAppendix, setShowAppendix] = useState(false);

  // --- DESIGN SYSTEM (from P4 JSON) ---
  const designSystem = {
    colors: { /* from color_palette */ },
    fonts: { /* from typography with fallbacks */ }
  };

  // --- SLIDES DATA (from P4 JSON) ---
  const slides = [ /* main slide objects */ ];
  const appendixSlides = [ /* appendix slide objects */ ];
  const allSlides = [...slides, ...appendixSlides];

  // --- KEYBOARD NAVIGATION ---
  useEffect(() => {
    const handleKeyDown = (e) => {
      if (e.key === 'ArrowRight') setCurrentSlide(p => Math.min(p + 1, allSlides.length - 1));
      if (e.key === 'ArrowLeft') setCurrentSlide(p => Math.max(p - 1, 0));
      if (e.key === 'a') setShowAppendix(p => !p);
    };
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [allSlides.length]);

  // --- PPTXGENJS LOADER ---
  const loadPptxGenJS = async () => { /* CDN script injection */ };

  // --- CHART RENDERERS (SVG for preview) ---
  const renderChart = (chartSpec) => { /* SVG generation */ };

  // --- PPTX EXPORT WITH ERROR HANDLING ---
  const handleDownload = async () => {
    setIsGenerating(true);
    setError(null);
    try {
      const PptxGenJS = await loadPptxGenJS();
      // ... generate slides ...
    } catch (err) {
      setError(`Export failed: ${err.message}`);
    } finally {
      setIsGenerating(false);
    }
  };

  // --- SLIDE RENDERER (by template type) ---
  const renderSlide = (slideData) => { /* switch on layout_template */ };

  // --- MAIN RENDER ---
  return (
    <div style={styles.container}>
      {/* Error banner if error */}
      {error && <div style={styles.error}>{error}</div>}

      {/* Header: title + download button */}
      <header style={styles.header}>
        <h1>{designSystem.title}</h1>
        <button onClick={handleDownload} disabled={isGenerating}>
          {isGenerating ? 'Generating...' : 'Download PPTX'}
        </button>
      </header>

      {/* Slide preview area */}
      <main style={styles.slideContainer}>
        {renderSlide(allSlides[currentSlide])}
      </main>

      {/* Navigation: prev/next + slide counter */}
      <nav style={styles.navigation}>
        <button onClick={() => setCurrentSlide(p => Math.max(p - 1, 0))}>‚Üê</button>
        <span>{currentSlide + 1} / {allSlides.length}</span>
        <button onClick={() => setCurrentSlide(p => Math.min(p + 1, allSlides.length - 1))}>‚Üí</button>
        {appendixSlides.length > 0 && (
          <button onClick={() => setShowAppendix(p => !p)}>
            {showAppendix ? 'Hide' : 'Show'} Appendix
          </button>
        )}
      </nav>

      {/* Appendix section (if toggled) */}
      {showAppendix && renderAppendixSection()}

      {/* Keyboard hints */}
      <footer style={styles.hints}>
        ‚Üê ‚Üí Navigate | A: Toggle Appendix | Home/End: First/Last
      </footer>
    </div>
  );
}
```

### 6.2 Code Density Selection

| Section | Verbose Lines | Standard Lines | Dense Lines | Selected |
|---------|---------------|----------------|-------------|----------|
| State setup | 25 | 15 | 8 | Standard |
| Design system | 40 | 25 | 15 | Standard |
| Slide renderer | 150 | 100 | 60 | Standard |
| Chart renderer | 200 | 120 | 70 | Standard |
| PPTX export | 180 | 100 | 55 | Standard |
| UI components | 100 | 60 | 35 | Standard |
| **Total** | **695** | **420** | **243** | **Standard** |

---

## Pass 7: Validation & Testing

### 7.1 Artifact Syntax Check

| Check | Status |
|-------|--------|
| Valid JSX syntax | ‚úÖ/‚ùå |
| All hooks imported | ‚úÖ/‚ùå |
| No external dependencies | ‚úÖ/‚ùå |
| All styles inline | ‚úÖ/‚ùå |
| Export default present | ‚úÖ/‚ùå |

### 7.2 Preview Functionality

| Check | Status |
|-------|--------|
| All [#] slides render | ‚úÖ/‚ùå |
| Navigation works | ‚úÖ/‚ùå |
| Colors match design system | ‚úÖ/‚ùå |
| Charts display correctly | ‚úÖ/‚ùå |
| Responsive to container | ‚úÖ/‚ùå |

### 7.3 Export Functionality

| Check | Status |
|-------|--------|
| PptxGenJS loads | ‚úÖ/‚ùå |
| Download triggers | ‚úÖ/‚ùå |
| .pptx file valid | ‚úÖ/‚ùå |
| All slides present | ‚úÖ/‚ùå |
| Charts render in PowerPoint | ‚úÖ/‚ùå |
| Speaker notes included | ‚úÖ/‚ùå |

### 7.4 Content Integrity

| Check | Status |
|-------|--------|
| All content from JSON | ‚úÖ/‚ùå |
| No content added/removed | ‚úÖ/‚ùå |
| Traceability preserved | ‚úÖ/‚ùå |
| Confidence flags in notes | ‚úÖ/‚ùå |

---

# OUTPUT FORMAT

## Primary Output: React Artifact

The main output is a **complete, executable React component** wrapped in an artifact code block:

~~~jsx
// Artifact: slide-presentation
// Description: Interactive slide deck with preview and PPTX download

import React, { useState } from 'react';

export default function SlideDeck() {
  // [Complete implementation]
}
~~~

## Secondary Outputs

### CoT Decision Log

| Decision Point | Selected Option | Key Rationale |
|----------------|-----------------|---------------|
| Component architecture | | |
| Rendering strategy | | |
| Chart approach | | |
| PptxGenJS integration | | |

### CoD Density Log

| Section | Final Density | Line Count |
|---------|---------------|------------|
| | | |

### Validation Report

| Category | Checks | Passed |
|----------|--------|--------|
| Syntax | | |
| Preview | | |
| Export | | |
| Content | | |

---

# JSON SPECIFICATION INPUT

## Pipeline Mode

Use the STAGE_4_HANDOFF package from Stage 4, specifically:

```markdown
### Required from STAGE_4_HANDOFF:

1. **JSON_SPECIFICATION**: The complete JSON object containing:
   - `presentation.metadata`
   - `presentation.design_system`
   - `presentation.slides[]`

2. **DESIGN_SYSTEM_SUMMARY**: Quick reference for colors/fonts

3. **COT_DECISION_SUMMARY**: Design decisions to honor
```

## Standalone Mode

Provide a valid JSON slide specification following P4's output schema:

```json
{
  "presentation": {
    "metadata": {
      "title": "string",
      "governing_thought": "string (‚â§25 words)",
      "duration_minutes": "number",
      "slide_count": "number",
      "appendix_count": "number",
      "framework": "string",
      "schema_version": "1.0"
    },
    "design_system": {
      "color_palette": {
        "primary": "#hex",
        "secondary": "#hex",
        "accent": "#hex",
        "background": "#hex",
        "text_primary": "#hex",
        "text_secondary": "#hex",
        "chart_colors": ["#hex array"]
      },
      "typography": {
        "title_font": "string",
        "title_size": "number (pt)",
        "body_font": "string",
        "body_size": "number (pt)",
        "font_fallback": ["web-safe fallbacks"]
      }
    },
    "slides": [
      {
        "slide_number": 1,
        "slide_id": "S1",
        "type": "string (title|section|content|chart|comparison|action|closing)",
        "layout_template": "string (title_centered|title_content|content_visual_split|chart_focus|two_column|section_divider|action_items|appendix)",
        "title": {
          "text": "string",
          "density_versions": {
            "verbose": "string",
            "standard": "string",
            "dense": "string"
          },
          "selected_density": "string"
        },
        "content_blocks": [
          {
            "block_id": "string",
            "type": "string (paragraph|bullet_list|numbered_list|callout_box|data_point|table)",
            "content": {
              "text": "string or array",
              "density_versions": {}
            }
          }
        ],
        "visual_elements": [
          {
            "element_id": "string",
            "type": "string (chart|image|icon)",
            "chart_spec": {
              "chart_type": "bar_vertical|bar_horizontal|line|pie|donut",
              "data": {},
              "colors": []
            }
          }
        ],
        "speaker_notes": {
          "full_notes": "string",
          "key_points": ["array"],
          "confidence_flags": ["array"]
        },
        "traceability": {
          "f_ids": ["array"],
          "q_refs": ["array"]
        }
      }
    ],
    "appendix_slides": [
      {
        "appendix_id": "A1",
        "trigger_question": "string",
        "title": "string",
        "content": {}
      }
    ]
  }
}
```

---

**Pipeline Mode**: The STAGE_4_HANDOFF package will be provided here.

**Standalone Mode**: Paste JSON specification here.

[Input goes here]

---

# GENERATION BRIEF (Optional)

**Presentation Title**: [Override title for download filename]

**Color Theme Override**: [If different from JSON]

**Export Filename**: [Default: presentation.pptx]

**Include Speaker Notes**: [Yes / No ‚Äî default Yes]

**Thumbnail Strip**: [Yes / No ‚Äî default No]

---

# BEGIN

Execute Passes 1‚Äì7. Output:
1. Complete React artifact (primary deliverable)
2. CoT Decision Log
3. CoD Density Log
4. Validation Report

---

# üì¶ FINAL DELIVERABLES PACKAGE

**As the final stage of the pipeline**, after generating the React artifact, compile and output the following final deliverables package:

```markdown
<<<FINAL_DELIVERABLES>>>

# PIPELINE COMPLETE

## Research Topic
[Original research brief - carried through all five stages]

## Pipeline Execution Summary
| Stage | Status | Key Metrics |
|-------|--------|-------------|
| 1 - Deep Research | ‚úÖ Complete | [X] findings, [Y] sources across [Z] tiers |
| 2 - Executive Summary | ‚úÖ Complete | [X] words, [Density] density |
| 3 - Presentation Outline | ‚úÖ Complete | [X] main slides + [Y] appendix |
| 4 - Slide Design Spec | ‚úÖ Complete | JSON v1.0, [X] layouts, [Y] charts |
| 5 - React Artifact | ‚úÖ Complete | Preview + PPTX export ready |

## Cumulative Metadata
| Field | Value |
|-------|-------|
| Research Depth | [Brief/Standard/Comprehensive] |
| Summary Density | [Sparse/Moderate/Rich] |
| Presentation Complexity | [Low/Medium/High] |
| Total Research Questions | [#] |
| Total Findings | [#] |
| Total Sources | [#] by tier: T1=[#], T2=[#], T3=[#], T4=[#] |
| Data Freshness | [Date of most recent source] |
| JSON Schema Version | 1.0 |
| Artifact Type | React + PptxGenJS |
| Pipeline Executed | [Date] |

---

## DELIVERABLE 1: Raw Research
**Location**: See Stage 1 output (not duplicated to conserve context)

**Quick Reference**:
- Research Questions: [#] primary, [#] sub-questions
- Key Findings: [#] with confidence breakdown
- Source Documentation: Appendix A in Stage 1 output

---

## DELIVERABLE 2: Executive Summary
**Location**: See Stage 2 output (not duplicated to conserve context)

**Quick Reference**:
- Core Thesis: [Single sentence]
- Narrative Arc: [Pattern used]
- Word Count: [#]

---

## DELIVERABLE 3: Presentation Outline
**Location**: See Stage 3 output (not duplicated to conserve context)

**Quick Reference**:
- Governing Thought: [Single sentence]
- Framework: [Pattern used]
- Slide Count: [#] main + [#] appendix

---

## DELIVERABLE 4: JSON Slide Specification
**Location**: See Stage 4 output (not duplicated to conserve context)

**Quick Reference**:
- Schema Version: 1.0
- Design System: [Theme summary]
- Layout Templates: [#]
- Charts Specified: [#]

---

## DELIVERABLE 5: React Artifact
**The artifact above IS Deliverable 5**

**Features**:
- ‚úÖ Live slide preview in browser
- ‚úÖ Navigation controls (prev/next, slide counter)
- ‚úÖ Download button generating real .pptx file
- ‚úÖ Design system faithfully rendered
- ‚úÖ Charts rendered (SVG preview, native PPTX charts)
- ‚úÖ Speaker notes included in export

**Usage Instructions**:
1. The artifact renders automatically in Claude.ai
2. Use arrow buttons or keyboard to navigate slides
3. Click "Download PPTX" to save presentation
4. Open .pptx in PowerPoint, Keynote, or Google Slides

---

## APPENDIX: Master Source List

**Tier 1 (Regulatory/Official)**:
| Abbreviation | Full Name | Used In Stages |
|--------------|-----------|----------------|
| [Abbrev] | [Full name] | 1, 2, 3, 4, 5 |

**Tier 2 (International Orgs/Big 4)**:
| Abbreviation | Full Name | Used In Stages |
|--------------|-----------|----------------|
| [Abbrev] | [Full name] | 1, 2, 3 |

**Tier 3-4**: [Similar format]

---

## APPENDIX: Full Traceability Matrix

| Q-ID | F-ID | Confidence | Summary Section | Slide # | JSON Element | Artifact Slide |
|------|------|------------|-----------------|---------|--------------|----------------|
| Q1 | F1 | High | [Section] | 3 | slides[2] | slides[2] |
| Q1.1 | F2 | Medium | [Section] | 4, 5 | slides[3], slides[4] | slides[3], slides[4] |

---

## USAGE NOTES

### For React Artifact (Deliverable 5)
- **Preview**: Artifact auto-renders in Claude.ai conversation
- **Navigate**: Click arrows or use keyboard (‚Üê/‚Üí)
- **Download**: Click button to generate .pptx
- **Edit**: Copy artifact code to modify styling
- **Compatibility**: .pptx works in PowerPoint 2016+, Keynote, Google Slides

### Troubleshooting
- If download fails, try refreshing the artifact
- Charts may render slightly differently in PowerPoint vs preview
- For custom fonts, install fonts on local system before opening .pptx

---

## Data Freshness Warning
*Research conducted [date]. Data current as of [data freshness date]. For rapidly evolving topics, validate key statistics before presentation.*

## Presenter Preparation Checklist
- [ ] Review all 5 deliverables
- [ ] Preview slides in artifact
- [ ] Download .pptx file
- [ ] Open in PowerPoint/Keynote and verify formatting
- [ ] Review speaker notes
- [ ] Rehearse with timer
- [ ] Prepare for Q&A (Appendix slides)

<<<END_FINAL_DELIVERABLES>>>
```

---

# ‚úì PIPELINE COMPLETE

All five deliverables have been generated:
1. **Raw Research** ‚Äî Comprehensive analysis with full source documentation
2. **Executive Summary** ‚Äî Synthesized narrative for senior stakeholders
3. **Presentation Outline** ‚Äî Detailed slide-by-slide structure
4. **JSON Specification** ‚Äî Machine-readable design specification
5. **React Artifact** ‚Äî Interactive preview + downloadable .pptx

The user can now:
- **Preview** slides directly in Claude.ai
- **Download** a real PowerPoint file
- **Present** using PowerPoint, Keynote, or Google Slides

No Python. No local setup. Entire pipeline runs in Claude.ai.
